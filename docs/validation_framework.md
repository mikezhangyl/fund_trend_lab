# 急涨趋势模型验证框架

> 版本: v1.0
> 更新日期: 2026-01-15

---

## 1. 验证目标

- 评估急涨检测算法的准确性和实用性
- 测试算法在不同类型基金上的表现
- 为未来预测模型建立基准指标

---

## 2. 验证方法论

### 2.1 回看验证 (Lookback Validation)

**方法**: 在历史数据上滑动窗口检测急涨，验证事件覆盖率

```
时间轴: ────────────────────────────>
         [检测窗口] → [观察期]
         
检测窗口: 计算特征信号
观察期: 验证是否发生急涨
```

### 2.2 Walk-Forward 验证

**方法**: 模拟实时场景，每个时间点只使用历史数据

| 阶段 | 数据范围 | 用途 |
|------|----------|------|
| 训练 | T-365 到 T-30 | 学习急涨模式 |
| 验证 | T-30 到 T | 测试预测效果 |
| 滚动 | 每周前移窗口 | 持续验证 |

### 2.3 分层验证

按基金类型分组验证：

| 分类维度 | 分组 |
|----------|------|
| 资产类型 | 股票型、混合型、ETF |
| 主题 | 科技、消费、医药、金融 |
| 规模 | 大盘、中盘、小盘 |
| 波动性 | 高波动、中等、低波动 |

---

## 3. 评估指标

### 3.1 事件检测指标

| 指标 | 公式 | 目标 |
|------|------|------|
| **召回率** | 捕获的急涨 / 实际发生的急涨 | > 80% |
| **准确率** | 正确预警 / 总预警数 | > 60% |
| **F1 Score** | 2 × (准确率 × 召回率) / (准确率 + 召回率) | > 0.7 |

### 3.2 时效性指标

| 指标 | 说明 | 目标 |
|------|------|------|
| **提前天数** | 信号出现到急涨开始的平均天数 | > 5天 |
| **峰值捕获率** | 信号期间内包含涨幅峰值的比例 | > 70% |

### 3.3 风险指标

| 指标 | 说明 | 目标 |
|------|------|------|
| **最大回撤** | 信号后的最大向下波动 | < 15% |
| **假阳性率** | 误报 / 总信号数 | < 30% |

---

## 4. 验证测试计划

### Phase 1: 现有基金深度验证 (50+ 基金)

**目标**: 验证算法在已有数据上的表现

```python
# 伪代码
for fund in existing_funds:
    events = detector.scan_fund(fund)
    
    # 计算统计指标
    metrics = calculate_metrics(events, fund.history)
    
    # 记录结果
    results.append({
        'fund': fund.code,
        'type': fund.type,
        'event_count': len(events),
        'avg_gain': mean([e.total_gain for e in events]),
        'acceleration_rate': sum(e.is_accelerating for e in events) / len(events)
    })
```

**验证内容**:
- [ ] 各参数配置下的事件数量分布
- [ ] 不同窗口大小的检测效果对比
- [ ] 加速/非加速事件的后续表现差异

### Phase 2: 批量扩展测试 (500+ 基金)

**目标**: 验证算法在更大样本上的泛化能力

**测试步骤**:
1. 从 AKShare 获取公募基金列表（按规模、类型筛选）
2. 批量拉取历史数据
3. 运行急涨检测
4. 汇总统计分析

**样本选择**:
| 类型 | 数量 | 选择标准 |
|------|------|----------|
| 股票型 | 150 | 规模 > 1亿，成立 > 2年 |
| 混合型 | 150 | 规模 > 1亿，成立 > 2年 |
| 指数ETF | 100 | 日均成交 > 1000万 |
| 行业ETF | 100 | 各行业代表性基金 |

### Phase 3: 预测模型验证 (未来阶段)

**目标**: 验证预测模型的前瞻性

```
特征 → 模型 → 预测(未来N天是否急涨) → 对比实际结果
```

---

## 5. 执行脚本

### 5.1 批量验证脚本

```bash
# 运行完整验证
python scripts/run_validation.py --phase all

# 仅运行 Phase 1
python scripts/run_validation.py --phase 1 --funds existing

# 生成验证报告
python scripts/generate_validation_report.py --output docs/validation_report.md
```

### 5.2 结果输出

验证结果将保存到:
- `data/validation_results.json` - 详细数据
- `docs/validation_report.md` - 可读报告

---

## 6. 成功标准

| 指标 | 阈值 | 状态 |
|------|------|------|
| 事件覆盖率 | > 80% 的显著上涨被捕获 | ⏳ 待验证 |
| 类型一致性 | 各类型基金表现差异 < 20% | ⏳ 待验证 |
| 参数稳定性 | 参数微调不显著改变结果 | ⏳ 待验证 |

---

## 7. 下一步

1. [ ] 实现 `scripts/run_validation.py`
2. [ ] 扩展基金样本池
3. [ ] 运行 Phase 1 验证并分析结果
4. [ ] 根据结果调优参数
